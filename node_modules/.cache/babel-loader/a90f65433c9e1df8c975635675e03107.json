{"remainingRequest":"E:\\VScode-workplace\\project-SHP3\\node_modules\\babel-loader\\lib\\index.js!E:\\VScode-workplace\\project-SHP3\\src\\router\\index.js","dependencies":[{"path":"E:\\VScode-workplace\\project-SHP3\\src\\router\\index.js","mtime":1658126317963},{"path":"E:\\VScode-workplace\\project-SHP3\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1656639267156},{"path":"E:\\VScode-workplace\\project-SHP3\\node_modules\\babel-loader\\lib\\index.js","mtime":1656639277841}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"E:\\\\VScode-workplace\\\\project-SHP3\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport Vue from \"vue\";\nimport VueRouter from \"vue-router\";\nimport routes from \"./routes\";\nimport store from \"@/store\";\nVue.use(VueRouter);\nvar originalPush = VueRouter.prototype.push;\nvar originalReplace = VueRouter.prototype.replace;\n\nVueRouter.prototype.push = function (location, reslove, reject) {\n  if (reslove && reject) {\n    originalPush.call(this, location, reslove, reject);\n  } else {\n    originalPush.call(this, location, function () {}, function () {});\n  }\n};\n\nVueRouter.prototype.replace = function (location, reslove, reject) {\n  if (reslove && reject) {\n    originalReplace.call(this, location, reslove, reject);\n  } else {\n    originalPush.call(this, location, function () {}, function () {});\n  }\n};\n\nvar router = new VueRouter({\n  routes: routes,\n  //设置滚动条的位置\n  scrollBehavior: function scrollBehavior() {\n    //滚动行为这个函数,需要有返回值,返回值为一个对象。\n    //经常可以设置滚动条x|y位置 [x|y数值的设置一般最小是零]\n    return {\n      y: 0\n    };\n  }\n}); //全局守卫 前置守卫\n\nrouter.beforeEach(\n/*#__PURE__*/\nfunction () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee(to, from, next) {\n    var token, name;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            //to:去的那个路由的信息\n            //from:从那个路由而来的信息\n            //next:放行函数 next(/login)\n            //用户登录了才会有token\n            token = store.state.user.token;\n            name = store.state.user.userInfo.name;\n\n            if (!token) {\n              _context.next = 24;\n              break;\n            }\n\n            if (!(to.path == \"/login\")) {\n              _context.next = 7;\n              break;\n            }\n\n            next('/home');\n            _context.next = 22;\n            break;\n\n          case 7:\n            if (!name) {\n              _context.next = 11;\n              break;\n            }\n\n            next();\n            _context.next = 22;\n            break;\n\n          case 11:\n            _context.prev = 11;\n            _context.next = 14;\n            return store.dispatch(\"getUserInfo\");\n\n          case 14:\n            next();\n            _context.next = 22;\n            break;\n\n          case 17:\n            _context.prev = 17;\n            _context.t0 = _context[\"catch\"](11);\n            _context.next = 21;\n            return store.dispatch(\"userLogout\");\n\n          case 21:\n            // await commit('CLEARUSERINFO');\n            // console.log(to.path);\n            next('/login'); // router.push('/login')\n\n          case 22:\n            _context.next = 25;\n            break;\n\n          case 24:\n            next();\n\n          case 25:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[11, 17]]);\n  }));\n\n  return function (_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}());\nexport default router;",{"version":3,"sources":["E:\\VScode-workplace\\project-SHP3\\src\\router\\index.js"],"names":["Vue","VueRouter","routes","store","use","originalPush","prototype","push","originalReplace","replace","location","reslove","reject","call","router","scrollBehavior","y","beforeEach","to","from","next","token","state","user","name","userInfo","path","dispatch"],"mappings":";;;;AAAA,OAAOA,GAAP,MAAgB,KAAhB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,OAAOC,MAAP;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACAH,GAAG,CAACI,GAAJ,CAAQH,SAAR;AAEA,IAAMI,YAAY,GAAGJ,SAAS,CAACK,SAAV,CAAoBC,IAAzC;AACA,IAAMC,eAAe,GAAGP,SAAS,CAACK,SAAV,CAAoBG,OAA5C;;AAEAR,SAAS,CAACK,SAAV,CAAoBC,IAApB,GAA2B,UAASG,QAAT,EAAmBC,OAAnB,EAA4BC,MAA5B,EAAoC;AAC7D,MAAID,OAAO,IAAIC,MAAf,EAAuB;AACrBP,IAAAA,YAAY,CAACQ,IAAb,CAAkB,IAAlB,EAAwBH,QAAxB,EAAkCC,OAAlC,EAA2CC,MAA3C;AACD,GAFD,MAEO;AACLP,IAAAA,YAAY,CAACQ,IAAb,CAAkB,IAAlB,EAAwBH,QAAxB,EAAkC,YAAM,CAAE,CAA1C,EAA4C,YAAM,CAAE,CAApD;AACD;AACF,CAND;;AAOAT,SAAS,CAACK,SAAV,CAAoBG,OAApB,GAA8B,UAASC,QAAT,EAAmBC,OAAnB,EAA4BC,MAA5B,EAAoC;AAChE,MAAID,OAAO,IAAIC,MAAf,EAAuB;AACrBJ,IAAAA,eAAe,CAACK,IAAhB,CAAqB,IAArB,EAA2BH,QAA3B,EAAqCC,OAArC,EAA8CC,MAA9C;AACD,GAFD,MAEO;AACLP,IAAAA,YAAY,CAACQ,IAAb,CAAkB,IAAlB,EAAwBH,QAAxB,EAAkC,YAAM,CAAE,CAA1C,EAA4C,YAAM,CAAE,CAApD;AACD;AACF,CAND;;AAQA,IAAII,MAAM,GAAG,IAAIb,SAAJ,CAAc;AACzBC,EAAAA,MAAM,EAANA,MADyB;AAEzB;AACAa,EAAAA,cAHyB,4BAGR;AACf;AACA;AACA,WAAO;AAAEC,MAAAA,CAAC,EAAE;AAAL,KAAP;AACD;AAPwB,CAAd,CAAb,C,CASA;;AACAF,MAAM,CAACG,UAAP;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAkB,iBAAOC,EAAP,EAAWC,IAAX,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAChB;AACA;AACA;AACA;AACIC,YAAAA,KALY,GAKJlB,KAAK,CAACmB,KAAN,CAAYC,IAAZ,CAAiBF,KALb;AAMZG,YAAAA,IANY,GAMLrB,KAAK,CAACmB,KAAN,CAAYC,IAAZ,CAAiBE,QAAjB,CAA0BD,IANrB;;AAAA,iBAOZH,KAPY;AAAA;AAAA;AAAA;;AAAA,kBAQVH,EAAE,CAACQ,IAAH,IAAW,QARD;AAAA;AAAA;AAAA;;AASZN,YAAAA,IAAI,CAAC,OAAD,CAAJ;AATY;AAAA;;AAAA;AAAA,iBAWRI,IAXQ;AAAA;AAAA;AAAA;;AAYVJ,YAAAA,IAAI;AAZM;AAAA;;AAAA;AAAA;AAAA;AAAA,mBAeFjB,KAAK,CAACwB,QAAN,CAAe,aAAf,CAfE;;AAAA;AAgBRP,YAAAA,IAAI;AAhBI;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,mBAkBFjB,KAAK,CAACwB,QAAN,CAAe,YAAf,CAlBE;;AAAA;AAmBR;AACA;AACAP,YAAAA,IAAI,CAAC,QAAD,CAAJ,CArBQ,CAsBR;;AAtBQ;AAAA;AAAA;;AAAA;AA2BdA,YAAAA,IAAI;;AA3BU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAlB;;AAAA;AAAA;AAAA;AAAA;AA8BA,eAAeN,MAAf","sourcesContent":["import Vue from \"vue\";\r\nimport VueRouter from \"vue-router\";\r\nimport routes from \"./routes\";\r\nimport store from \"@/store\";\r\nVue.use(VueRouter);\r\n\r\nconst originalPush = VueRouter.prototype.push;\r\nconst originalReplace = VueRouter.prototype.replace;\r\n\r\nVueRouter.prototype.push = function(location, reslove, reject) {\r\n  if (reslove && reject) {\r\n    originalPush.call(this, location, reslove, reject);\r\n  } else {\r\n    originalPush.call(this, location, () => {}, () => {});\r\n  }\r\n};\r\nVueRouter.prototype.replace = function(location, reslove, reject) {\r\n  if (reslove && reject) {\r\n    originalReplace.call(this, location, reslove, reject);\r\n  } else {\r\n    originalPush.call(this, location, () => {}, () => {});\r\n  }\r\n};\r\n\r\nlet router = new VueRouter({\r\n  routes,\r\n  //设置滚动条的位置\r\n  scrollBehavior() {\r\n    //滚动行为这个函数,需要有返回值,返回值为一个对象。\r\n    //经常可以设置滚动条x|y位置 [x|y数值的设置一般最小是零]\r\n    return { y: 0 };\r\n  },\r\n});\r\n//全局守卫 前置守卫\r\nrouter.beforeEach(async (to, from, next) => {\r\n  //to:去的那个路由的信息\r\n  //from:从那个路由而来的信息\r\n  //next:放行函数 next(/login)\r\n  //用户登录了才会有token\r\n  let token = store.state.user.token;\r\n  let name = store.state.user.userInfo.name;\r\n  if (token) {\r\n    if (to.path == \"/login\") {\r\n      next('/home');\r\n    } else {\r\n      if (name) {\r\n        next();\r\n      } else {\r\n        try {\r\n          await store.dispatch(\"getUserInfo\");\r\n          next();\r\n        } catch (error) {\r\n          await store.dispatch(\"userLogout\")\r\n          // await commit('CLEARUSERINFO');\r\n          // console.log(to.path);\r\n          next('/login');\r\n          // router.push('/login')\r\n        }\r\n      }\r\n    }\r\n  }else{\r\n    next()\r\n  }\r\n});\r\nexport default router;\r\n"]}]}